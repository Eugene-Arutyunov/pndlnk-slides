{# Компонент ДКЦП (Дворец культуры ценностного предложения)
   Макрос для изоляции переменных и поддержки некорректных блоков
   
   Параметры:
   - values: Ценность (массив)
   - segment: Клиентский сегмент (массив)
   - conflict: Ключевой мотивационный конфликт (массив)
   - artifact: Артефакт (массив)
   - artifactAttrs: Атрибуты артефакта (массив)
   - exchangeConditions: Условия обмена (массив)
   - priceConditions: Ценовые условия (массив)
   - companyAttrs: Атрибуты компании (массив)
   - arguments: Аргументы (массив)
   - draft: Режим черновика (boolean, по умолчанию false)
   - invalidBlocks: Массив номеров некорректных блоков (по умолчанию [])
     Номера блоков: 1=segment, 2=conflict, 3=artifact, 4=artifactAttrs,
     5=price, 6=exchange, 7=company, 8=values, 9=arguments
#}

{% macro dkcp(
  values=[],
  segment=[],
  conflict=[],
  artifact=[],
  artifactAttrs=[],
  exchangeConditions=[],
  priceConditions=[],
  companyAttrs=[],
  arguments=[],
  draft=false,
  invalidBlocks=[]
) %}
  {% set isInvalid8 = false %}
  {%- for block in invalidBlocks -%}
    {%- if block == 8 -%}
      {%- set isInvalid8 = true -%}
    {%- endif -%}
  {%- endfor -%}
  {% set isInvalid1 = false %}
  {%- for block in invalidBlocks -%}
    {%- if block == 1 -%}
      {%- set isInvalid1 = true -%}
    {%- endif -%}
  {%- endfor -%}
  {% set isInvalid2 = false %}
  {%- for block in invalidBlocks -%}
    {%- if block == 2 -%}
      {%- set isInvalid2 = true -%}
    {%- endif -%}
  {%- endfor -%}
  {% set isInvalid3 = false %}
  {%- for block in invalidBlocks -%}
    {%- if block == 3 -%}
      {%- set isInvalid3 = true -%}
    {%- endif -%}
  {%- endfor -%}
  {% set isInvalid4 = false %}
  {%- for block in invalidBlocks -%}
    {%- if block == 4 -%}
      {%- set isInvalid4 = true -%}
    {%- endif -%}
  {%- endfor -%}
  {% set isInvalid5 = false %}
  {%- for block in invalidBlocks -%}
    {%- if block == 5 -%}
      {%- set isInvalid5 = true -%}
    {%- endif -%}
  {%- endfor -%}
  {% set isInvalid6 = false %}
  {%- for block in invalidBlocks -%}
    {%- if block == 6 -%}
      {%- set isInvalid6 = true -%}
    {%- endif -%}
  {%- endfor -%}
  {% set isInvalid7 = false %}
  {%- for block in invalidBlocks -%}
    {%- if block == 7 -%}
      {%- set isInvalid7 = true -%}
    {%- endif -%}
  {%- endfor -%}
  {% set isInvalid9 = false %}
  {%- for block in invalidBlocks -%}
    {%- if block == 9 -%}
      {%- set isInvalid9 = true -%}
    {%- endif -%}
  {%- endfor -%}
  
  <div class="dkcp-component{% if draft %} dkcp-component--draft{% endif %}">
    <div class="dkcp-top{% if isInvalid8 %} dkcp-top--invalid{% endif %}">
      <div class="dkcp-block values{% if isInvalid8 %} dkcp-block--invalid{% endif %}">
        <div class="dkcp-digit">8</div>
        <div class="dkcp-title">Ценность</div>
        <div class="dkcp-definition">
          {% if values %} {% for item in values %}
          <p>{{ item }}</p>
          {% endfor %} {% endif %}
        </div>
      </div>
    </div>

    <div class="dkcp-facade">
      <div class="dkcp-row columns">
        <div class="dkcp-block segment{% if isInvalid1 %} dkcp-block--invalid{% endif %}">
          <div class="dkcp-digit">1</div>
          <div class="dkcp-title">Клиентский сегмент</div>
          <div class="dkcp-definition">
            {% if segment %} {% for item in segment %}
            <p>{{ item }}</p>
            {% endfor %} {% endif %}
          </div>
          <div class="dkcp-hint"></div>
        </div>

        <div class="dkcp-block conflict{% if isInvalid2 %} dkcp-block--invalid{% endif %}">
          <div class="dkcp-digit">2</div>
          <div class="dkcp-title">Мотивационный конфликт</div>
          <div class="dkcp-definition">
            {% if conflict %} {% for item in conflict %}
            <p>{{ item }}</p>
            {% endfor %} {% endif %}
          </div>
          <div class="dkcp-hint"></div>
        </div>

        <div class="dkcp-block arguments{% if isInvalid9 %} dkcp-block--invalid{% endif %}">
          <div class="dkcp-digit">9</div>
          <div class="dkcp-title">Аргументы</div>
          <div class="dkcp-definition">
            {% if arguments %} {% for item in arguments %}
            <p>{{ item }}</p>
            {% endfor %} {% endif %}
          </div>
          <div class="dkcp-hint"></div>
        </div>

        <div class="dkcp-block artifact-attrs{% if isInvalid4 %} dkcp-block--invalid{% endif %}">
          <div class="dkcp-digit">4</div>
          <div class="dkcp-title">Атрибуты артефакта</div>
          <div class="dkcp-definition">
            {% if artifactAttrs %} {% for item in artifactAttrs %}
            <p>{{ item }}</p>
            {% endfor %} {% endif %}
          </div>
          <div class="dkcp-hint"></div>
        </div>
        <div class="dkcp-block artifact{% if isInvalid3 %} dkcp-block--invalid{% endif %}">
          <div class="dkcp-digit">3</div>
          <div class="dkcp-title">Артефакт</div>
          <div class="dkcp-definition">
            {% if artifact %} {% for item in artifact %}
            <p>{{ item }}</p>
            {% endfor %} {% endif %}
          </div>
          <div class="dkcp-hint"></div>
        </div>
      </div>

      <div class="dkcp-row bottom-row">
        <div class="dkcp-block price{% if isInvalid5 %} dkcp-block--invalid{% endif %}">
          <div class="dkcp-digit">5</div>
          <div class="dkcp-title">Вклад клиента</div>
          <div class="dkcp-definition">
            {% if priceConditions %} {% for item in priceConditions %}
            <p>{{ item }}</p>
            {% endfor %} {% endif %}
          </div>
        </div>
        <div class="dkcp-block exchange{% if isInvalid6 %} dkcp-block--invalid{% endif %}">
          <div class="dkcp-digit">6</div>
          <div class="dkcp-title">Условия обмена</div>
          <div class="dkcp-definition">
            {% if exchangeConditions %} {% for item in exchangeConditions %}
            <p>{{ item }}</p>
            {% endfor %} {% endif %}
          </div>
        </div>
      </div>
    </div>

    <div class="dkcp-bottom">
      <div class="dkcp-block company{% if isInvalid7 %} dkcp-block--invalid{% endif %}">
        <div class="dkcp-digit">7</div>
        <div class="dkcp-title">Атрибуты компании</div>
        <div class="dkcp-definition">
          {% if companyAttrs %} {% for item in companyAttrs %}
          <p>{{ item }}</p>
          {% endfor %} {% endif %}
        </div>
      </div>
    </div>
  </div>
{% endmacro %}
